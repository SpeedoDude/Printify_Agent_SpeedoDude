{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Legal Dashboard</h1>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Trademark & Patent Checker -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">Check for Trademark & Patent Issues</h2>
            <form id="legal-check-form">
                <div class="mb-4">
                    <label for="product-description" class="block text-gray-700 font-semibold mb-2">Product Title or Description</label>
                    <textarea id="product-description" class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" rows="4" required></textarea>
                </div>
                <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Check Now
                </button>
            </form>
            <div id="legal-check-result" class="mt-6"></div>
        </div>

        <!-- Legal Disclaimer Generator -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">Generate Legal Disclaimer</h2>
            <form id="disclaimer-form">
                <div class="mb-4">
                    <label for="product-type" class="block text-gray-700 font-semibold mb-2">Product Type</label>
                    <input type="text" id="product-type" class="w-full p-3 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="e.g., 'T-Shirt'" required>
                </div>
                <button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    Generate Disclaimer
                </button>
            </form>
            <div id="disclaimer-result" class="mt-6 p-4 bg-gray-100 rounded-md"></div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Handle legal check form
        const legalCheckForm = document.getElementById('legal-check-form');
        legalCheckForm.addEventListener('submit', function (event) {
            event.preventDefault();
            const description = document.getElementById('product-description').value;
            fetch('/api/legal/check', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ text: description })
            })
            .then(response => response.json())
            .then(data => {
                const resultContainer = document.getElementById('legal-check-result');
                let resultsHTML = '';
                if (data.trademark.status === 'failed') {
                    resultsHTML += `<div class="p-4 bg-red-100 text-red-700 rounded-md mb-2">${data.trademark.message}</div>`;
                } else {
                    resultsHTML += `<div class="p-4 bg-green-100 text-green-700 rounded-md mb-2">${data.trademark.message}</div>`;
                }
                if (data.patent.status === 'failed') {
                    resultsHTML += `<div class="p-4 bg-red-100 text-red-700 rounded-md">${data.patent.message}</div>`;
                } else {
                    resultsHTML += `<div class="p-4 bg-green-100 text-green-700 rounded-md">${data.patent.message}</div>`;
                }
                resultContainer.innerHTML = resultsHTML;
            });
        });

        // Handle disclaimer form
        const disclaimerForm = document.getElementById('disclaimer-form');
        disclaimerForm.addEventListener('submit', function (event) {
            event.preventDefault();
            const productType = document.getElementById('product-type').value;
            fetch('/api/legal/generate-disclaimer', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ product_type: productType })
            })
            .then(response => response.json())
            .then(data => {
                const resultContainer = document.getElementById('disclaimer-result');
                if (data.error) {
                    resultContainer.textContent = `Error: ${data.error}`;
                } else {
                    resultContainer.textContent = data.disclaimer;
                }
            });
        });
    });
</script>
{% endblock %}
